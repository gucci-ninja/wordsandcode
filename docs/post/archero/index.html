<!doctype html>
<html lang="en-us">
  <head>
    <title>How I Built an AI Assistant for my Operating System // Words &amp; Code</title>
    <link rel="shortcut icon" href="https://pngimage.net/wp-content/uploads/2018/05/bullet-style-png-3-300x200.png" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.134.1">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Suhavi Sandhu" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/wordsandcode/css/main.min.a7dfeaabca38e15028cf2fc45c1eca64f842bd62529f0bf081a55d5270f9d37a.css" />
    

    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="How I Built an AI Assistant for my Operating System">
  <meta name="twitter:description" content="archero how do I search for a file with the word skibidi OpenAI: Use the following command to search for files with the word &#34;skibidi&#34; in their name in the current directory and its subdirectories: find . -type f -iname &#34;*skibidi*&#34; Why build an AI assistant for Arch Linux My operating system of choice is Arch Linux. I installed it around 6 years ago and have been too lazy to switch to anything else. Also, itâ€™s worked pretty well for me all these years so I donâ€™t have any reason to. Of course, there are times when I fall behind on updates and everything starts to break. Things start to break so much that even updating wonâ€™t solve them. Every time this happens, I spend a good 2-3 hours of my day troubleshooting. I reference documentation, arch forums and a more recent addition - ChatGPT.">

    <meta property="og:url" content="https://gucci-ninja.github.io/wordsandcode/post/archero/">
  <meta property="og:site_name" content="Words & Code">
  <meta property="og:title" content="How I Built an AI Assistant for my Operating System">
  <meta property="og:description" content="archero how do I search for a file with the word skibidi OpenAI: Use the following command to search for files with the word &#34;skibidi&#34; in their name in the current directory and its subdirectories: find . -type f -iname &#34;*skibidi*&#34; Why build an AI assistant for Arch Linux My operating system of choice is Arch Linux. I installed it around 6 years ago and have been too lazy to switch to anything else. Also, itâ€™s worked pretty well for me all these years so I donâ€™t have any reason to. Of course, there are times when I fall behind on updates and everything starts to break. Things start to break so much that even updating wonâ€™t solve them. Every time this happens, I spend a good 2-3 hours of my day troubleshooting. I reference documentation, arch forums and a more recent addition - ChatGPT.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-09-08T21:35:59-04:00">
    <meta property="article:modified_time" content="2024-09-08T21:35:59-04:00">


  </head>
  <body>
    <header class="app-header">
      <a href="/wordsandcode/"><img class="app-header-avatar" src="/wordsandcode/img/avatar.jpg" alt="Suhavi Sandhu" /></a>
      <span class="app-header-title">Words &amp; Code</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/wordsandcode/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/wordsandcode/about/">About</a>
             - 
          
          <a class="app-header-menu-item" href="/wordsandcode/post/design_review_tips/">8 Tips for Effective Design Reviews</a>
             - 
          
          <a class="app-header-menu-item" href="/wordsandcode/post/thanksgiving/">A-Z Tech to be thankful for in 2020</a>
             - 
          
          <a class="app-header-menu-item" href="/wordsandcode/post/ai_abc/">AI ABCs</a>
             - 
          
          <a class="app-header-menu-item" href="/wordsandcode/post/elastic_cc/">Elastic Community Conference Tech Talk</a>
             - 
          
          <a class="app-header-menu-item" href="/wordsandcode/post/flutter_rive_tutorial/">Flutter Web and Rive Animation Tutorial</a>
             - 
          
          <a class="app-header-menu-item" href="/wordsandcode/post/archero/">How I Built an AI Assistant for my Operating System</a>
             - 
          
          <a class="app-header-menu-item" href="/wordsandcode/post/open_source/">How to start contributing to open source</a>
             - 
          
          <a class="app-header-menu-item" href="/wordsandcode/post/kafka_summit/">Kafka Summit Tech Talk</a>
             - 
          
          <a class="app-header-menu-item" href="/wordsandcode/post/ai_search/">Using FAISS for local semantic search</a>
             - 
          
          <a class="app-header-menu-item" href="/wordsandcode/post/arch_linux/">Your Guide to Arch Linux</a>
      </nav>
      <p>Software engineer passionate about building powerful, useful and open source systems. Thanks for dropping by! ðŸ’›</p>
      <div class="app-header-social">
        
          <a href="https://github.com/gucci-ninja" target="_blank" rel="noreferrer noopener me">
            <svg class="icon icon-github" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>github</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
          </a>
        
          <a href="https://twitter.com/SuhaviSandhu" target="_blank" rel="noreferrer noopener me">
            <svg class="icon icon-twitter" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>twitter</title><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
          </a>
        
          <a href="https://www.linkedin.com/in/suhavi/" target="_blank" rel="noreferrer noopener me">
            <svg class="icon icon-linkedin" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>linkedin</title><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">How I Built an AI Assistant for my Operating System</h1>
      <div class="post-meta">
        <div>
          <svg class="icon icon-calendar" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          Sep 8, 2024
        </div>
        <div>
          <svg class="icon icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>clock</title><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
          7 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>archero how <span style="color:#66d9ef">do</span> I search <span style="color:#66d9ef">for</span> a file with the word skibidi
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OpenAI: Use the following command to search <span style="color:#66d9ef">for</span> files with the word <span style="color:#e6db74">&#34;skibidi&#34;</span> in their name in the current directory and its subdirectories:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    find . -type f -iname <span style="color:#e6db74">&#34;*skibidi*&#34;</span>
</span></span></code></pre></div><h3 id="why-build-an-ai-assistant-for-arch-linux">Why build an AI assistant for Arch Linux</h3>
<p>My operating system of choice is Arch Linux. I installed it around 6 years ago and have been too lazy to switch to anything else. Also, itâ€™s worked pretty well for me all these years so I donâ€™t have any reason to. Of course, there are times when I fall behind on updates and everything starts to break. Things start to break so much that even updating wonâ€™t solve them. Every time this happens, I spend a good 2-3 hours of my day troubleshooting. I reference documentation, arch forums and a more recent addition - ChatGPT.</p>
<p>Last week I decided that Iâ€™m done dealing with issues and need easy answers. So I decided to build a personalized AI assistant and integrate it into my terminal! It can be invoked in my terminal session, has access to my terminal history as well as OS specifications. Itâ€™s been pretty helpful to me so far so I thought I would share steps to set it up for anyone who is interested. Not that I&rsquo;ve tried but, if you&rsquo;re using a different distro of Linux I think this guide could still come in handy.</p>
<h3 id="step-1---set-up-an-openai-account">Step 1 - Set Up an OpenAI Account</h3>
<p>Before we start coding, youâ€™ll need access to OpenAI&rsquo;s API. Head over to <a href="https://platform.openai.com/">OpenAI&rsquo;s platform</a> and create an account if you donâ€™t already have one. Once signed up, create a new project under the <strong>API</strong> section, and generate an API key for your project. This key will be used in your Python program to communicate with OpenAIâ€™s servers.</p>
<h3 id="step-2---install-dependencies">Step 2 - Install Dependencies</h3>
<p>For this project, Iâ€™m using Python 3.12.5, so make sure that your system has it installed. Youâ€™ll also need <code>pip3</code>, which is Pythonâ€™s package installer. After setting that up, install the <code>openai</code> library:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip3 install openai
</span></span></code></pre></div><p>I used version 1.43.0 of <code>openai</code>, which worked well for this purpose. With that in place, youâ€™re ready to start coding!</p>
<h3 id="step-3---build-the-general-ai-client">Step 3 - Build the General AI Client</h3>
<p>Letâ€™s start by building a basic AI client that interacts with OpenAIâ€™s API. Create a Python file (<code>ai_client.py</code>) and add the following code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> openai <span style="color:#f92672">import</span> OpenAI
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize client with API key</span>
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> OpenAI(api_key<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;your-openai-api-key-here&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize messages that will be exchanged with client</span>
</span></span><span style="display:flex;"><span>messages <span style="color:#f92672">=</span> [ {<span style="color:#e6db74">&#34;role&#34;</span>: <span style="color:#e6db74">&#34;system&#34;</span>, <span style="color:#e6db74">&#34;content&#34;</span>: 
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">&#34;You are a intelligent assistant.&#34;</span>} ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">ask_openai</span>(prompt):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> prompt:
</span></span><span style="display:flex;"><span>        messages<span style="color:#f92672">.</span>append({<span style="color:#e6db74">&#34;role&#34;</span>: <span style="color:#e6db74">&#34;user&#34;</span>, <span style="color:#e6db74">&#34;content&#34;</span>: prompt})
</span></span><span style="display:flex;"><span>        chat <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>chat<span style="color:#f92672">.</span>completions<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>            model<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;gpt-3.5-turbo&#34;</span>,
</span></span><span style="display:flex;"><span>            messages<span style="color:#f92672">=</span>messages
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    response <span style="color:#f92672">=</span> chat<span style="color:#f92672">.</span>choices[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>message<span style="color:#f92672">.</span>content
</span></span><span style="display:flex;"><span>    messages<span style="color:#f92672">.</span>append({<span style="color:#e6db74">&#34;role&#34;</span>: <span style="color:#e6db74">&#34;assistant&#34;</span>, <span style="color:#e6db74">&#34;content&#34;</span>: response})
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> response
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    prompt <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#34;Ask OpenAI: &#34;</span>)
</span></span><span style="display:flex;"><span>    answer <span style="color:#f92672">=</span> ask_openai(prompt)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;OpenAI: </span><span style="color:#e6db74">{</span>answer<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p>In this code:</p>
<ul>
<li>Iâ€™m using the GPT-3.5 Turbo model to handle queries.</li>
<li>The <code>ask_openai</code> function takes user input, sends it to the API, and returns the response.</li>
</ul>
<p>To test this, run the Python file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python3 ai_client.py
</span></span></code></pre></div><p>When prompted, type in any query, and the response from OpenAI will be printed to your terminal.</p>
<h3 id="step-4---make-it-invokable-via-command-line">Step 4 - Make It Invokable via Command Line</h3>
<p>To make things even smoother, I wanted to invoke my AI client directly from the terminal using a custom command, such as <code>archero</code>.</p>
<ol>
<li>Create a shell script named <code>archero</code> in a directory that&rsquo;s in your <code>PATH</code>, such as <code>/usr/local/bin</code></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nano /usr/local/bin/archero
</span></span></code></pre></div><ol>
<li>Add the following content to the file</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>python3 /path/to/your/python/ai_client.py <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><ol>
<li>Make the file executable</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo chmod +x /usr/local/bin/archero
</span></span></code></pre></div><ol>
<li>Replace the main method with the following so it picks up all arguments after <code>archero</code></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Usage: archero &lt;your query&gt;&#34;</span>)
</span></span><span style="display:flex;"><span>        sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    prompt <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">.</span>join(sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>:])
</span></span><span style="display:flex;"><span>    answer <span style="color:#f92672">=</span> ask_openai(prompt)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;OpenAI: </span><span style="color:#e6db74">{</span>answer<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p>Now you can invoke your client by simply typing <code>archero</code> followed by a query, like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>archero how <span style="color:#66d9ef">do</span> I update my system
</span></span></code></pre></div><p>At this point I was getting a generic response like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>OpenAI: To update your system, I would need to know which operating system you are using.
</span></span></code></pre></div><h3 id="step-5---integrate-terminal-history">Step 5 - Integrate Terminal History</h3>
<p>The next step was to give the AI some context from the commands I had already tried in the terminal. Since I use Fish shell, the command history is stored in <code>~/.local/share/fish/fish_history</code>. Hereâ€™s how I updated my AI client to use this history:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_terminal_history</span>():
</span></span><span style="display:flex;"><span>    history_file <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>expanduser(<span style="color:#e6db74">&#34;~/.local/share/fish/fish_history&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> open(history_file, <span style="color:#e6db74">&#34;r&#34;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>            history <span style="color:#f92672">=</span> file<span style="color:#f92672">.</span>readlines()
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Fish history format: lines starting with &#39;- cmd: &#39; are actual commands</span>
</span></span><span style="display:flex;"><span>            commands <span style="color:#f92672">=</span> [line<span style="color:#f92672">.</span>strip()[<span style="color:#ae81ff">6</span>:] <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> history <span style="color:#66d9ef">if</span> line<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#39;- cmd: &#39;</span>)]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Error reading history file: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        commands <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> commands
</span></span></code></pre></div><p>Now, my AI client includes recent commands Iâ€™ve run in the terminal in its prompt. This way, the AI can better understand what Iâ€™ve already tried and provide more relevant suggestions.</p>
<p>For other popular shells you can also find the terminal history</p>
<ul>
<li>for Bash - <code>~/.bash_history</code></li>
<li>for zsh - <code>~/.zsh_history</code></li>
</ul>
<h3 id="step-6---add-system-info-using-neofetch">Step 6 - Add System Info Using Neofetch</h3>
<p>Finally, I wanted my AI to also know about my systemâ€™s specifications. For this, I used <code>neofetch</code>, a tool that displays your system information in the terminal. The output from <code>neofetch</code> contains ANSI escape codes, so I cleaned it up before passing it to the AI.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> subprocess
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_neofetch_output</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Run the neofetch command and capture its output</span>
</span></span><span style="display:flex;"><span>        output <span style="color:#f92672">=</span> subprocess<span style="color:#f92672">.</span>check_output([<span style="color:#e6db74">&#39;neofetch&#39;</span>, <span style="color:#e6db74">&#39;--stdout&#39;</span>])<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Use regular expression to remove ANSI escape codes</span>
</span></span><span style="display:flex;"><span>        clean_output <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>sub(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;\x1B\[[0-?]*[ -/]*[@-~]&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>, output)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Error running neofetch: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        clean_output <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Neofetch could not be run.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> clean_output
</span></span></code></pre></div><p>By adding the output from <code>neofetch</code>, the AI client now understands the specifics of my operating system, hardware, and more, allowing it to provide even more tailored responses.</p>
<h3 id="final-code">Final Code</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> openai <span style="color:#f92672">import</span> OpenAI
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> subprocess
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize client with API key</span>
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> OpenAI(api_key<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;your-openai-api-key-here&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize messages that will be exchanged with client</span>
</span></span><span style="display:flex;"><span>messages <span style="color:#f92672">=</span> [ {<span style="color:#e6db74">&#34;role&#34;</span>: <span style="color:#e6db74">&#34;system&#34;</span>, <span style="color:#e6db74">&#34;content&#34;</span>: 
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">&#34;You are a intelligent assistant.&#34;</span>} ]
</span></span><span style="display:flex;"><span>              
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_neofetch_output</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Run the neofetch command and capture its output</span>
</span></span><span style="display:flex;"><span>        output <span style="color:#f92672">=</span> subprocess<span style="color:#f92672">.</span>check_output([<span style="color:#e6db74">&#39;neofetch&#39;</span>, <span style="color:#e6db74">&#39;--stdout&#39;</span>])<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Use regular expression to remove ANSI escape codes</span>
</span></span><span style="display:flex;"><span>        clean_output <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>sub(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;\x1B\[[0-?]*[ -/]*[@-~]&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>, output)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Error running neofetch: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        clean_output <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Neofetch could not be run.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> clean_output
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_terminal_history</span>():
</span></span><span style="display:flex;"><span>    history_file <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>expanduser(<span style="color:#e6db74">&#34;~/.local/share/fish/fish_history&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> open(history_file, <span style="color:#e6db74">&#34;r&#34;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>            history <span style="color:#f92672">=</span> file<span style="color:#f92672">.</span>readlines()
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Fish history format: lines starting with &#39;- cmd: &#39; are actual commands</span>
</span></span><span style="display:flex;"><span>            commands <span style="color:#f92672">=</span> [line<span style="color:#f92672">.</span>strip()[<span style="color:#ae81ff">6</span>:] <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> history <span style="color:#66d9ef">if</span> line<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#39;- cmd: &#39;</span>)]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Error reading history file: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        commands <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> commands
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">ask_openai</span>(prompt, terminal_history, system_info):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Combine terminal history, system information, and the user&#39;s prompt</span>
</span></span><span style="display:flex;"><span>    full_prompt <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Here is my recent terminal history: </span><span style="color:#e6db74">{</span><span style="color:#e6db74">&#39;, &#39;</span><span style="color:#f92672">.</span>join(terminal_history[<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>:])<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span> \
</span></span><span style="display:flex;"><span>                  <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;My system specifications: </span><span style="color:#e6db74">{</span>system_info<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span> \
</span></span><span style="display:flex;"><span>                  <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Question: </span><span style="color:#e6db74">{</span>prompt<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> full_prompt:
</span></span><span style="display:flex;"><span>        messages<span style="color:#f92672">.</span>append(
</span></span><span style="display:flex;"><span>            {<span style="color:#e6db74">&#34;role&#34;</span>: <span style="color:#e6db74">&#34;user&#34;</span>, <span style="color:#e6db74">&#34;content&#34;</span>: full_prompt},
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        chat <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>chat<span style="color:#f92672">.</span>completions<span style="color:#f92672">.</span>create(model<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;gpt-3.5-turbo&#34;</span>, messages<span style="color:#f92672">=</span>messages)
</span></span><span style="display:flex;"><span>    response <span style="color:#f92672">=</span> chat<span style="color:#f92672">.</span>choices[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>message<span style="color:#f92672">.</span>content
</span></span><span style="display:flex;"><span>    messages<span style="color:#f92672">.</span>append({<span style="color:#e6db74">&#34;role&#34;</span>: <span style="color:#e6db74">&#34;assistant&#34;</span>, <span style="color:#e6db74">&#34;content&#34;</span>: response})
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> response
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Usage: archero &lt;your query&gt;&#34;</span>)
</span></span><span style="display:flex;"><span>        sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    prompt <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">.</span>join(sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>:])
</span></span><span style="display:flex;"><span>    terminal_history <span style="color:#f92672">=</span> get_terminal_history()
</span></span><span style="display:flex;"><span>    system_info <span style="color:#f92672">=</span> get_neofetch_output()
</span></span><span style="display:flex;"><span>    answer <span style="color:#f92672">=</span> ask_openai(prompt, terminal_history, system_info)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;OpenAI: </span><span style="color:#e6db74">{</span>answer<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p>In just a few steps, I built an AI client that integrates seamlessly with my terminal, using Fish shell history and system information to provide smarter responses. Itâ€™s been a huge time-saver, especially when troubleshooting issues on my Arch Linux system.</p>
<p>Now when I ask something like <code>archero how do I update my system</code>  I get a more catered response like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>why don<span style="color:#e6db74">&#39;t you ask ur mum</span>
</span></span></code></pre></div><p>Feel free to adapt the steps to your environment and enjoy the convenience of having your own AI assistant directly in your terminal! Full code is available in my dotfiles repository here: <a href="https://github.com/gucci-ninja/.dotfiles/blob/master/archero.py">https://github.com/gucci-ninja/.dotfiles/blob/master/archero.py</a></p>
<p>Actual response (for legal purposes):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>OpenAI: To update your Arch Linux system, you can use the following commands in your terminal:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>1. First, update the package repositories and package list:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo pacman -Sy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>2. Then, upgrade all installed packages to their latest versions:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo pacman -Su
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>3. Finally, you can also clean up any cached packages that are no longer required by running:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo pacman -Sc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Remember to carefully review the package changes before proceeding with the update. It<span style="color:#960050;background-color:#1e0010">&#39;</span>s important to keep your system up to date to ensure security and stability.
</span></span></code></pre></div>
    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
